<%- include('partials/headers/header-menu') -%>

  <main class="container container-post">
    <section class="container-section-post">
      <%if(team.user==user.id || user.teams.includes(team.team)){ %>
        <section class="section-profile-post">
          <section class="nav-profile-post">
            <img
              src="https://res.cloudinary.com/dprkasf7b/image/upload/c_thumb,w_200,g_face/v1664241356/soccer_t6mqfe.jpg"
              class="post-img-top img-fluid" alt=" ...">
            <section class="section-column-post">
              <section class="section-row-post">
                <section class="section-main-player-info">
                  <section class="section-each-extra-post">
                    <h1>
                      <%= team.team %>
                    </h1>
                  </section>
                  <section class="section-each-extra-post">
                    <h2>
                      <%= team.sport %>
                    </h2>
                  </section>
                </section>
                <section class="section-icons-post">
                  <form action="/teams/editTeam/<%= team.id %>?_method=PUT" method="POST">
                    <button class="btn" type="submit">
                      <i class="fa-regular fa-pen-to-square fa-xl post-btn hover-top"></i>
                    </button>
                  </form>
                  <form action="/teams/pinTeam/<%= team.id %>?_method=PUT" method="POST">
                    <button class="btn" type="submit" data-bs-toggle="tooltip" data-bs-placement="top"
                      data-bs-title="Pin it">
                      <% if (team.pinned==true ) { %>
                        <i class="fa-solid fa-thumbtack fa-xl pinned-btn"></i>
                        <% } else { %>
                          <i class="fa-solid fa-thumbtack fa-xl unpinned-btn"></i>
                          <% } %>
                    </button>
                  </form>
                  <form action="/teams/deleteTeam/<%= team.id %>?_method=DELETE" method="POST">
                    <button class="btn" type="submit">
                      <i class="fa-regular fa-trash-can fa-xl post-btn hover-top"></i>
                    </button>
                  </form>
                </section>
              </section>
              <section class="section-secondary-player-info">
                <!-- <section class="section-person-post-extra-one">
                  <section class="section-each-extra-post">
                    <h2>
                      <%= %>
                    </h2>
                    <span>height</span>
                  </section>
                  <section class="section-each-extra-post">
                    <h2>
                      <%= %>
                    </h2>
                    <span>weight</span>
                  </section>
                </section> -->
                <!-- <section class="section-person-post-extra-two">
                  
                </section> -->
                <section class="section-each-extra-post">
                  <h2>
                    <%= team.win %>-<%= team.loss%> | <%=
                          `.${(Number(team.win)/(Number(team.win)+Number(team.loss))).toFixed(3).toString().split('.')[1]}`
                          %>%
                  </h2>
                  <span>w-l | pct </span>
                </section>
                <section class="section-each-extra-post">
                  <h2>
                    <%= team.sport %>
                  </h2>
                  <span>sport</span>
                </section>
                <section class="section-each-extra-post">
                  <h2>
                    <%= team.numberofplayers %>
                  </h2>
                  <span># of players</span>
                </section>
              </section>
            </section>
          </section>
        </section>
        <section class="section-table-post">
          <section class="section-team-stats">
            <h3 class="team-stats-header ">TEAM STATS</h3>
            <table class="team-table table table-bordered table-striped table-responsive-md text-center table-hover">
              <thead>
                <tr class="table-head">
                  <th>MATCHUP</th>
                  <th>W/L</th>
                  <% if (team.sport=='BASKETBALL' ) { %>
                    <th>PTS</th>
                    <th>REB</th>
                    <th>AST</th>
                    <th>STL</th>
                    <th>BLK</th>
                    <th>TOV</th>
                    <th>PF</th>
                    <% } else if (team.sport=='BASEBALL' ) { %>
                      <th>RUNS</th>
                      <th>HITS</th>
                      <th>2B</th>
                      <th>3B</th>
                      <th>HR</th>
                      <th>RBI</th>
                      <th>SO</th>
                      <% } else if (team.sport=='FOOTBALL' ) { %>
                        <th>TDs</th>
                        <th>PASSING YARDS</th>
                        <th>RUSHING YARDS</th>
                        <th>POINTS</th>
                        <th>FUMBLES</th>
                        <th>INTERCEPTIONS</th>
                        <th>SACKS</th>
                        <% } else if (team.sport=='SOCCER' ) { %>
                          <th>GOALS</th>
                          <th>SHOTS ON TARGET</th>
                          <th>PK</th>
                          <th>CORNERS</th>
                          <th>YELLOW CARDS</th>
                          <th>RED CARDS</th>
                          <th>OWN GOALS</th>
                          <% } else { %>
                            <th>TBD</th>
                            <th>TBD</th>
                            <th>TBD</th>
                            <th>TBD</th>
                            <th>TBD</th>
                            <th>TBD</th>
                            <th>TBD</th>
                            <% } %>
                              <th></th>
                              <th id="add-row">
                                <button type="button" class="btn add-row" data-bs-toggle="modal"
                                  data-bs-target="#team-add-row">
                                  <i class="fa-solid fa-circle-plus fa-xl add-row-btn"></i>
                                </button>
                              </th>
                </tr>
              </thead>
              <tbody>
                <% if (team.table.length> 0) { %>
                  <% team.table.sort((a, b)=> b.row.cell1-a.row.cell1).forEach(el=> { %>
                    <tr class="table-light">
                      <td>
                        <%= el.row.cell1 %>
                      </td>
                      <td>
                        <%= el.row.cell2 %>
                      </td>
                      <td>
                        <%= el.row.cell3 %>
                      </td>
                      <td>
                        <%= el.row.cell4 %>
                      </td>
                      <td>
                        <%= el.row.cell5 %>
                      </td>
                      <td>
                        <%= el.row.cell6 %>
                      </td>
                      <td>
                        <%= el.row.cell7 %>
                      </td>
                      <td>
                        <%= el.row.cell8 %>
                      </td>
                      <td>
                        <%= el.row.cell9 %>
                      </td>
                      <td class="btns-table">
                        <button class="btn" type="button" data-bs-toggle="modal" data-bs-target="#team-edit-row">
                          <i class="fa-regular fa-pen-to-square fa-lg post-btn"></i>
                        </button>
                      </td>
                      <td class="btns-table">
                        <form action="/teams/deleteRow/<%= el._id %>?_method=DELETE" method="POST">
                          <button class="btn" type="submit">
                            <i class="fa-regular fa-trash-can fa-lg post-btn"></i>
                          </button>
                        </form>
                      </td>
                    </tr>


                    <!-- EDIT ROW MODAL -->

                    <div class="modal fade" id="team-edit-row" tabindex="-1" role="dialog"
                      aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                      <div class="modal-dialog modal-dialog-centered" role="document">
                        <div class="modal-content">
                          <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLongTitle">Edit Row</h5>
                            <i class="fa-solid fa-square-xmark close" data-bs-dismiss="modal"></i>
                          </div>
                          <div class="modal-body">
                            <div class="mb-3">
                              <form action="/teams/editRow/<%= el._id %>?_method=PUT" method="POST"
                                class="team-edit-modal">
                                <div class="mb-3">
                                  <label for="cell1" class="form-label edit-label"></label>
                                  <input type="text" class="form-control form-control-sm" id="cell1" name="cell1"
                                    placeholder="" value="<%= el.row.cell1 %>">
                                </div>
                                <div class="mb-3">
                                  <label for="cell2" class="form-label edit-label"></label>
                                  <input type="text" class="form-control form-control-sm" id="cell2" name="cell2"
                                    placeholder="" value="<%= el.row.cell2 %>">
                                </div>
                                <div class="mb-3">
                                  <label for="cell3" class="form-label edit-label"></label>
                                  <input type="text" class="form-control form-control-sm" id="cell3" name="cell3"
                                    placeholder="#" value="<%= el.row.cell3 %>">
                                </div>
                                <div class="mb-3">
                                  <label for="cell4" class="form-label edit-label"></label>
                                  <input type="text" class="form-control form-control-sm" id="cell4" name="cell4"
                                    placeholder="#" value="<%= el.row.cell4 %>">
                                </div>
                                <div class="mb-3">
                                  <label for="cell5" class="form-label edit-label"></label>
                                  <input type="text" class="form-control form-control-sm" id="cell5" name="cell5"
                                    placeholder="#" value="<%= el.row.cell5 %>">
                                </div>
                                <div class="mb-3">
                                  <label for="cell6" class="form-label edit-label"></label>
                                  <input type="text" class="form-control form-control-sm" id="cell6" name="cell6"
                                    placeholder="#" value="<%= el.row.cell6 %>">
                                </div>
                                <div class="mb-3">
                                  <label for="cell7" class="form-label edit-label"></label>
                                  <input type="text" class="form-control form-control-sm" id="cell7" name="cell7"
                                    placeholder="#" value="<%= el.row.cell7 %>">
                                </div>
                                <div class="mb-3">
                                  <label for="cell8" class="form-label edit-label"></label>
                                  <input type="text" class="form-control form-control-sm" id="cell8" name="cell8"
                                    placeholder="#" value="<%= el.row.cell8 %>">
                                </div>
                                <div class="mb-3">
                                  <label for="cell9" class="form-label edit-label"></label>
                                  <input type="text" class="form-control form-control-sm" id="cell9" name="cell9"
                                    placeholder="#" value="<%= el.row.cell9 %>">
                                </div>
                                <div class="modal-footer">
                                  <button type="submit" class="btn btn-primary submit" value="Upload">Submit</button>
                                </div>
                              </form>
                            </div>
                          </div>
                        </div>
                      </div>
                      <% })} %>
              </tbody>
            </table>
            <%- include('partials/team-table-modal') -%>
          </section>
          <section class="section-players-stats">
            <h3 class="team-stats-header">PLAYER STATS</h3>
            <!-- <table class="team-table table table-bordered table-striped table-responsive-md text-center table-hover">
            </table> -->
          </section>
        </section>
        <% } %>
    </section>
  </main>

  <%- include('partials/footer') -%>